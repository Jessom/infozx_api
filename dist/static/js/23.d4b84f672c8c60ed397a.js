webpackJsonp([23],{GyFr:function(o,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=n("xt+v"),i=n("mvHQ"),a=n.n(i),s=n("Dd8w"),r=n.n(s),c=n("6U54"),l=n("qWou"),u={props:{options:{type:Object,default:function(){return{}}}},computed:{opt:function(){return mui.extend({},{zoom:12,isLocation:!1,companyAddr:"苏州市金门路1200号",locationStyle:{iconLabel:{innerHTML:""},iconStyle:""}},this.options)}},data:function(){var o=this;return{network:{},coordsType:"gps",locationAddress:{},events:{init:function(t){o.map=t,o.options.init=!0,new AMap.Geocoder({city:"全国"}).getLocation(o.opt.companyAddr,function(n,e){o.getLocation(n,e,t)})}}}},created:function(){var o=this;mui.plusReady(function(){o.network=Object(l.a)()})},methods:{getLocation:function(o,t,n){"complete"===o&&"OK"===t.info&&this.netLocation(n)},geocoder:function(o){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];if(o.addr){var a=new AMap.Geocoder({city:"全国"});a.getLocation(o.addr,function(a,s){if("complete"===a&&"OK"===s.info){var r=c.c(s,n.map,e,t);i(mui.extend({},o,{include:r.contains(n.position)}))}})}else if(o.lng&&o.lat){o.lng=Number(o.lng),o.lat=Number(o.lat);var s=mui.extend(o,t);c.b(s,this.map,function(o){n.marker=o}),e=r()({},e,{lng:o.lng,lat:o.lat});var l=c.a(e,this.map);console.log(this.position),i(mui.extend({},o,{include:l.contains(this.position)}))}},netLocation:function(){var o=this,t=this.map;3==this.network.no?this.currentPos(t,function(n){o.amapLocation(t)}):mui.os.plus?this.currentPos(t,function(o){mui.toast("当前非WIFI网络,请打开定位服务")}):this.amapLocation(t)},currentPos:function(o,t){var n=this;mui.plusReady(function(){plus.geolocation.getCurrentPosition(function(t){console.log("调用原生GPS定位"),console.log(a()(t)),n.coordsType=t.coordsType,mui.os.ios?n.transformCoord(t,function(e){console.log("经过处理"),console.log(a()(e)),n.amapLocation(o,{lat:e.result[0].y,lng:e.result[0].x},t)},function(e){n.amapLocation(o,{lat:t.coords.latitude,lng:t.coords.longitude},t)}):n.amapLocation(o,{lat:t.coords.latitude,lng:t.coords.longitude},t)},function(o){t(o)},{geocode:!0})})},transformCoord:function(o,t,n){mui.ajax({url:"http://api.map.baidu.com/geoconv/v1/?coords="+o.coords.longitude+","+o.coords.latitude+"&from=1&to=3&ak=efWzpkW5jPMcPfrcaa9wQHatiKQ5la7o",type:"GET",success:function(o){0===o.status?t(o):n(o)},error:function(o){mui.toast("请检查网络后再试")}})},amapLocation:function(o,t,n){var i=this;if(t){var a=new AMap.LngLat(t.lng,t.lat);AMap.convertFrom(a,this.coordsType,function(t,a){"complete"===t&&(i.position=[a.locations[0].lng,a.locations[0].lat],i.opt.locationStyle.lng=a.locations[0].lng,i.opt.locationStyle.lat=a.locations[0].lat,i.marker?i.marker.setPosition(new AMap.LngLat(a.locations[0].lng,a.locations[0].lat)):c.b(i.opt.locationStyle,o,function(o){i.marker=o}),i.getLocationAddr(n),e.a.$emit("sendAddr",i.locationAddress),i.options.isLocation=!0)})}else o.plugin("AMap.Geolocation",function(){var t=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"});o.addControl(t),t.getCurrentPosition(),AMap.event.addListener(t,"complete",function(t){console.log(t),i.opt.locationStyle.lng=t.position.lng,i.opt.locationStyle.lat=t.position.lat,i.marker?i.marker.setPosition(new AMap.LngLat(t.position.lng,t.position.lat)):c.b(i.opt.locationStyle,o,function(o){i.marker=o,console.log(o)}),i.getLocationAddr(t),e.a.$emit("sendAddr",i.locationAddress),i.position=[t.position.lng,t.position.lat],i.options.isLocation=!0}),AMap.event.addListener(t,"error",function(o){})})},getLocationAddr:function(o){console.log(o);var t=o.coords||o.position,n=o.address||o.addressComponent,e={lat:t.latitude||t.lat||0,lng:t.longitude||t.lng||0};console.log(n);var i={province:n.province||"",city:n.city||"",district:n.district||"",street:n.street||"",streetNum:n.streetNum||n.streetNumber||"",poiName:n.poiName||"",building:n.building};this.locationAddress={position:e,address:i,formattedAddress:n.addresses||o.formattedAddress}}}},d={render:function(){var o=this.$createElement,t=this._self._c||o;return t("div",{staticClass:"z-geo-multi-map-wrap"},[t("el-amap",{ref:"map",staticClass:"z-amap-wrap",attrs:{vid:"amap",zoom:this.opt.zoom,events:this.events,doubleClickZoom:!1}})],1)},staticRenderFns:[]};var p={data:function(){return{addr:"",options:{isLocation:!1,init:!1}}},created:function(){e.a.$on("sendAddr",function(o){console.log(o)})},methods:{add:function(){this.$refs.map.geocoder({lng:11123,lat:4652,id:1},{},{radius:200},function(o){console.log(o)})}},components:{GeoMultiMap:n("VU/8")(u,d,!1,function(o){n("Lcon")},null,null).exports}},m={render:function(){var o=this,t=o.$createElement,n=o._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"map-wrap"},[n("geo-multi-map",{ref:"map",attrs:{options:o.options}})],1),o._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:o.addr,expression:"addr"}],attrs:{type:"text"},domProps:{value:o.addr},on:{input:function(t){t.target.composing||(o.addr=t.target.value)}}}),o._v(" "),n("button",{staticClass:"mui-btn mui-btn-block",on:{tap:o.add}},[o._v("添加")])])},staticRenderFns:[]};var f=n("VU/8")(p,m,!1,function(o){n("lWrF")},"data-v-6d281b0a",null);t.default=f.exports},Lcon:function(o,t){},lWrF:function(o,t){},qWou:function(o,t,n){"use strict";n.d(t,"a",function(){return e});var e=function(){var o={},t={no:1,name:"无网络"};o[plus.networkinfo.CONNECTION_UNKNOW]="Unknown connection",o[plus.networkinfo.CONNECTION_NONE]="None connection",o[plus.networkinfo.CONNECTION_ETHERNET]="Ethernet connection",o[plus.networkinfo.CONNECTION_WIFI]="WiFi connection",o[plus.networkinfo.CONNECTION_CELL2G]="Cellular 2G connection",o[plus.networkinfo.CONNECTION_CELL3G]="Cellular 3G connection",o[plus.networkinfo.CONNECTION_CELL4G]="Cellular 4G connection";var n=plus.networkinfo.getCurrentType();return 3===n&&(t={no:3,name:"WIFI网络"}),n>3&&(t={no:2,name:"移动流量"}),1===n&&(t={no:1,name:"无网络"}),t}}});
//# sourceMappingURL=23.d4b84f672c8c60ed397a.js.map