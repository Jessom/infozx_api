{"version":3,"sources":["webpack:///src/components/Map/GeolocationMap.vue","webpack:///./src/components/Map/GeolocationMap.vue?79e6","webpack:///./src/components/Map/GeolocationMap.vue","webpack:///src/views/map/gelocationMap.vue","webpack:///./src/views/map/gelocationMap.vue?ac94","webpack:///./src/views/map/gelocationMap.vue","webpack:///./src/common/js/native.js"],"names":["GeolocationMap","props","options","type","Object","default","data","self","this","network","coordsType","locationAddress","events","init","map","AMap","Geocoder","city","getLocation","opt","companyAddr","status","result","computed","mui","extend","zoom","isLocation","isContains","circleStyle","companyStyle","marker","locationStyle","iconLabel","innerHTML","iconStyle","created","_this","plusReady","js_native","methods","info","circle","amap","netLocation","_this2","no","currentPos","err","amapLocation","os","plus","toast","geocoder","addr","style","arguments","length","undefined","_this3","callback","typeof_default","Number","optison","m","extends_default","lng","lat","po","contains","position","point","ecb","_this4","geolocation","getCurrentPosition","pos","console","log","stringify_default","ios","transformCoord","res","y","x","coords","latitude","longitude","geocode","successcb","errorcb","ajax","url","success","error","gps","_this5","lnglat","LngLat","convertFrom","locations","getLocationAddr","bus","$emit","getContains","plugin","Geolocation","enableHighAccuracy","timeout","buttonOffset","Pixel","zoomToAccuracy","buttonPosition","addControl","event","addListener","onComplete","setPosition","onError","radius","latlng","address","addressComponent","province","district","street","streetNum","streetNumber","poiName","building","formattedAddress","addresses","getLocat","Map_GeolocationMap","render","_h","$createElement","_c","_self","staticClass","ref","attrs","vid","doubleClickZoom","staticRenderFns","gelocationMap","loc","location","$refs","msg","alert","punch","components","__webpack_require__","normalizeComponent","ssrContext","map_gelocationMap","_vm","_v","on","tap","_s","gelocationMap_Component","gelocationMap_normalizeComponent","__webpack_exports__","d","getNetWorkInfo","types","name","networkinfo","CONNECTION_UNKNOW","CONNECTION_NONE","CONNECTION_ETHERNET","CONNECTION_WIFI","CONNECTION_CELL2G","CONNECTION_CELL3G","CONNECTION_CELL4G","getCurrentType"],"mappings":"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","file":"static/js/21.d4df2ffddbd57b93a8e8.js","sourcesContent":["<template>\r\n\t<div class=\"z-map-container\">\r\n\t\t<el-amap class=\"z-amap-wrap\" vid=\"amap\" :zoom=\"opt.zoom\" ref=\"map\" :events=\"events\" :doubleClickZoom=\"false\">\r\n    </el-amap>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport * as amapMethods from '@/common/js/amap'\r\nimport { bus } from '@/common/js/bus'\r\nimport { getNetWorkInfo } from '@/common/js/native'\r\nexport default {\r\n\tprops: {\r\n\t\toptions: {\r\n\t\t\ttype: Object,\r\n\t\t\tdefault: function() { return {} }\r\n\t\t}\r\n\t},\r\n\tdata() {\r\n\t\tconst self = this\r\n\t\treturn {\r\n\t\t\tnetwork: {},\t\t\t\t\t\t// 网络状态\r\n\t\t\tcoordsType: 'gps',\t\t\t// 定位方式\r\n\t\t\tlocationAddress: {},\t\t// 保存定位后的地址\r\n\t\t\tevents: {\r\n\t\t\t\tinit(map) {\r\n\t\t\t\t\tself.map = map\r\n\t\t\t\t\tself.options.init = true\r\n\t\t\t\t\tlet geocoder = new AMap.Geocoder({ city: \"全国\" })\r\n\t\t\t\t\tgeocoder.getLocation(self.opt.companyAddr, function(status, result) {\r\n\t\t\t\t\t\tself.getLocation(status, result, map)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tcomputed: {\r\n\t\topt() {\r\n\t\t\tlet opt = {\r\n\t\t\t\tzoom: 12,\r\n\t\t\t\tcompanyAddr: '苏州市金门路1200号安得装饰',\r\n\t\t\t\tisLocation: false,\t\t\t// 定位完成\r\n\t\t\t\tisContains: false,\t\t\t// 是否在圆圈范围\r\n\t\t\t\tcircleStyle: {},\t\t\t\t// 圆圈样式\r\n\t\t\t\tcompanyStyle: {},\t\t\t\t// 公司位置marker样式\r\n\t\t\t\tmarker: null,\r\n\t\t\t\tlocationStyle: {\t\t\t\t// 当前位置marker样式\r\n\t\t\t\t\ticonLabel: {\r\n\t\t\t\t\t\tinnerHTML: '',\r\n\t\t\t\t\t},\r\n\t\t\t\t\ticonStyle: ''\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn mui.extend(true, {}, opt, this.options)\r\n\t\t}\r\n\t},\r\n\tcreated() {\r\n\t\tmui.plusReady(() => {\r\n\t\t\tthis.network = getNetWorkInfo()\r\n\t\t})\r\n\t},\r\n\tmethods: {\r\n\t\t// 定位\r\n\t\tgetLocation(status, result, map) {\r\n\t\t\tif(status === \"complete\" && result.info === \"OK\") {\r\n\t\t\t\tthis.circle = amapMethods.geocoder(result, map, this.opt.circleStyle, this.opt.companyStyle)\r\n\t\t\t\tthis.netLocation(map)\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 根据不同的忘了状态，使用不同的定位方式\r\n\t\tnetLocation() {\r\n\t\t\tlet map = this.map\r\n\t\t\tif(this.network.no == 3) {\r\n\t\t\t\t// wifi开启情况，如果开启的gps定位，则使用gps定位，否则使用网络定位\r\n\t\t\t\tthis.currentPos(map, err => {\r\n          this.amapLocation(map)\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tif(mui.os.plus) {\r\n\t\t\t\t\t// 非wifi情况下，不开启gps定位无法获取位置信息\r\n\t\t\t\t\tthis.currentPos(map, err => {\r\n\t\t\t\t\t\tmui.toast(\"当前非WIFI网络,请打开定位服务\")\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 网页版，使用amap定位\r\n\t\t\t\t\tthis.amapLocation(map)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 添加地点\r\n\t\tgeocoder(addr, style={}, circle={}, callback) {\r\n\t\t\tif(typeof addr === 'object') {\r\n\t\t\t\taddr['lng'] = Number(addr['lng'])\r\n\t\t\t\taddr['lat'] = Number(addr['lat'])\r\n\t\t\t\tlet optison = mui.extend(addr, style)\r\n\t\t\t\tamapMethods.addSimpleMarker(optison, this.map, m => {\r\n      \t\tthis.marker = m\r\n      \t})\r\n      \tcircle = {...circle, lng: addr['lng'], lat: addr['lat']}\r\n      \tlet po = amapMethods.addCircle(circle, this.map)\r\n      \tcallback(po.contains(this.position))\r\n\t\t\t} else {\r\n\t\t\t\tlet geocoder = new AMap.Geocoder({ city: \"全国\" })\r\n\t\t\t\tgeocoder.getLocation(addr, (status, result) => {\r\n\t\t\t\t\tif(status === 'complete' && result.info === \"OK\") {\r\n\t\t\t\t\t\tlet point = amapMethods.geocoder(result, this.map, circle, style)\r\n\t\t\t\t\t\tcallback(point.contains(this.position))\r\n\t\t\t\t\t\t// console.log(a.contains(this.position))\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 调用原生gps定位，获取位置信息\r\n\t\tcurrentPos(map, ecb) {\r\n\t\t\tmui.plusReady(() => {\r\n\t\t\t\tplus.geolocation.getCurrentPosition(pos => {\r\n\t\t\t\t\tconsole.log('调用原生GPS定位')\r\n\t\t\t\t\tconsole.log(JSON.stringify(pos))\r\n\t\t\t\t\tthis.coordsType = pos.coordsType\r\n\t\t\t\t\t// IOS平台定位偏差，查看MUI文档(http://www.dcloud.io/docs/api/zh_cn/geolocation.html#plus.geolocation.PositionOptions)是因为不支持高德地图，采用的定位方式是【wgs84】\r\n\t\t\t\t\t// 这里使用百度地图坐标转换API，将【wgs84】转换为【gcj02】\r\n\t\t\t\t\tif(mui.os.ios) {\r\n\t\t\t\t\t\tthis.transformCoord(pos, res => {\r\n\t\t\t\t\t\t\tconsole.log('经过处理')\r\n\t\t\t\t\t\t\tconsole.log(JSON.stringify(res))\r\n\t\t\t\t\t\t\tthis.amapLocation(map, {\r\n\t\t\t        \tlat: res.result[0].y,\r\n\t\t\t        \tlng: res.result[0].x\r\n\t\t\t        }, pos)\r\n\t\t\t\t\t\t}, err => {\r\n\t\t\t\t\t\t\tthis.amapLocation(map, {\r\n\t\t\t        \tlat: pos.coords.latitude,\r\n\t\t\t        \tlng: pos.coords.longitude\r\n\t\t\t        }, pos)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.amapLocation(map, {\r\n\t\t        \tlat: pos.coords.latitude,\r\n\t\t        \tlng: pos.coords.longitude\r\n\t\t        }, pos)\r\n\t\t\t\t\t}\r\n\t\t\t\t}, err => {\r\n\t\t\t\t\tecb(err)\r\n\t\t\t\t}, { geocode: true })\r\n\t\t\t})\r\n\t\t},\r\n\t\t// 调用百度地图坐标转换API\r\n\t\ttransformCoord(pos, successcb, errorcb) {\r\n\t\t\tmui.ajax({\r\n\t\t\t\turl: `http://api.map.baidu.com/geoconv/v1/?coords=${pos.coords.longitude},${pos.coords.latitude}&from=1&to=3&ak=efWzpkW5jPMcPfrcaa9wQHatiKQ5la7o`,\r\n\t\t\t\ttype: 'GET',\r\n\t\t\t\tsuccess: data => {\r\n\t\t\t\t\tif(data.status === 0) {\r\n\t\t\t\t\t\tsuccesscb(data)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\terrorcb(data)\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\terror: err => {\r\n\t\t\t\t\tmui.toast('请检查网络后再试')\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\t// amap定位\r\n\t\tamapLocation(map, gps, pos) {\r\n\t\t\tif(gps) {\r\n\t\t\t\tlet lnglat = new AMap.LngLat(gps.lng, gps.lat)\r\n        AMap.convertFrom(lnglat, this.coordsType, (status, data) => {\r\n          if (status === \"complete\") {\r\n            this.position = [data.locations[0].lng, data.locations[0].lat]\r\n            this.opt.locationStyle['lng'] = data.locations[0].lng\r\n            this.opt.locationStyle['lat'] = data.locations[0].lat\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t/* if(!this.marker) {\r\n            \tamapMethods.addSimpleMarker(this.opt.locationStyle, map, m => {\r\n            \t\tthis.marker = m\r\n            \t})\r\n          \t} else {\r\n          \t\tthis.marker.setPosition(new AMap.LngLat(data.locations[0].lng, data.locations[0].lat))\r\n          \t} */\r\n\r\n            this.getLocationAddr(pos)\r\n            bus.$emit('sendAddr', this.locationAddress)\r\n            this.options.isContains = this.getContains()\r\n            this.options.isLocation = true \t\t\t// 定位成功\r\n          }\r\n        })\r\n\t\t\t} else {\r\n\t\t\t\tmap.plugin(\"AMap.Geolocation\", () => {\r\n          let geolocation = new AMap.Geolocation({\r\n            enableHighAccuracy: true, //是否使用高精度定位，默认:true\r\n            timeout: 10000, //超过10秒后停止定位，默认：无穷大\r\n            buttonOffset: new AMap.Pixel(10, 20), //定位按钮与设置的停靠位置的偏移量，默认：Pixel(10, 20)\r\n            zoomToAccuracy: true, //定位成功后调整地图视野范围使定位位置及精度范围视野内可见，默认：false\r\n            buttonPosition: \"RB\"\r\n          })\r\n          map.addControl(geolocation)\r\n          geolocation.getCurrentPosition()\r\n          AMap.event.addListener(geolocation, \"complete\", onComplete => {\r\n          \tthis.opt.locationStyle['lng'] = onComplete.position.lng\r\n          \tthis.opt.locationStyle['lat'] = onComplete.position.lat\r\n          \tif(!this.marker) {\r\n            \tamapMethods.addSimpleMarker(this.opt.locationStyle, map, m => {\r\n            \t\tthis.marker = m\r\n            \t\tconsole.log(m)\r\n            \t})\r\n          \t} else {\r\n          \t\tthis.marker.setPosition(new AMap.LngLat(onComplete.position.lng, onComplete.position.lat))\r\n          \t}\r\n\r\n            this.getLocationAddr(onComplete)\r\n            bus.$emit('sendAddr', this.locationAddress)\r\n            this.position = [onComplete.position.lng, onComplete.position.lat]\r\n            this.options.isContains = this.getContains()\r\n            this.options.isLocation = true\r\n          }); //返回定位信息\r\n          AMap.event.addListener(geolocation, \"error\", onError => {}) //返回定位出错信息\r\n        })\r\n\t\t\t}\r\n\t\t},\r\n\t\t// 是否在围栏中\r\n\t\tgetContains() {\r\n\t\t\tif(this.opt.circleStyle.radius === 0) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn this.circle.contains(this.position)\r\n\t\t},\r\n\t\t// 解析定位后的地理位置\r\n\t\tgetLocationAddr(pos) {\r\n\t\t\tconsole.log(pos)\r\n\t\t\tlet latlng = pos.coords || pos.position\r\n\t\t\tlet addr = pos.address || pos.addressComponent\r\n\t\t\tlet position = {\r\n\t\t\t\tlat: latlng.latitude || latlng.lat || 0,\r\n\t\t\t\tlng: latlng.longitude || latlng.lng || 0,\r\n\t\t\t}\r\n\t\t\tconsole.log(addr)\r\n\t\t\tlet address = {\r\n\t\t\t\tprovince: addr.province || \"\",\r\n\t\t\t\tcity: addr.city || \"\",\r\n\t\t\t\tdistrict: addr.district || \"\",\r\n\t\t\t\tstreet: addr.street || \"\",\r\n\t\t\t\tstreetNum: addr.streetNum || addr.streetNumber || \"\",\r\n\t\t\t\tpoiName: addr.poiName || \"\",\r\n\t\t\t\tbuilding: addr.building\r\n\t\t\t}\r\n\t\t\tthis.locationAddress = {\r\n\t\t\t\tposition: position,\r\n\t\t\t\taddress: address,\r\n\t\t\t\tformattedAddress: addr.addresses || pos.formattedAddress\r\n\t\t\t}\r\n\t\t},\r\n\t\tgetLocat() {\r\n\t\t\treturn this.locationAddress\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang='scss'>\r\n.z-map-container, .z-map-container .z-amap-wrap {\r\n\theight: 100%;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/Map/GeolocationMap.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"z-map-container\"},[_c('el-amap',{ref:\"map\",staticClass:\"z-amap-wrap\",attrs:{\"vid\":\"amap\",\"zoom\":_vm.opt.zoom,\"events\":_vm.events,\"doubleClickZoom\":false}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-35e78ad3\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Map/GeolocationMap.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-35e78ad3\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./GeolocationMap.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GeolocationMap.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./GeolocationMap.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-35e78ad3\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./GeolocationMap.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Map/GeolocationMap.vue\n// module id = null\n// module chunks = ","<template lang=\"html\">\r\n  <div class=\"container\">\r\n  \t<div class=\"map-wrap\">\r\n  \t\t<geolocation-map ref='map' :options='options' />\r\n  \t</div>\r\n\r\n  \t<button class=\"mui-btn mui-btn-block mui-block-primary\" @tap='location'>重新定位</button>\r\n\r\n  \t<button class=\"mui-btn mui-btn-block mui-block-primary\" @tap='getLocat'>获取位置信息</button>\r\n\r\n  \t<div>{{loc}}</div>\r\n\r\n  \t<button class=\"mui-btn mui-btn-block mui-block-primary\" @tap='success'>定位完成了没</button>\r\n\r\n  \t<button class=\"mui-btn mui-btn-block mui-block-primary\" @tap='punch'>是否在打卡范围</button>\r\n\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport GeolocationMap from '@/components/Map/GeolocationMap.vue'\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloc: null,\r\n\t\t\toptions: {\r\n\t\t\t\tcompanyAddr: '苏州市寒山寺',\t\t\t// 公司地址\r\n\t\t\t\tisLocation: false,\t\t\t// 定位完成 必须\r\n\t\t\t\tisContains: false \t\t\t// 是否在圈内\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tlocation() {\r\n\t\t\tthis.$refs.map.netLocation()\r\n\t\t},\r\n\t\tgetLocat() {\r\n\t\t\tthis.loc = this.$refs.map.getLocat()\r\n\t\t},\r\n\t\tsuccess() {\r\n\t\t\tlet msg = this.options.isLocation ? \"定位完成\" : \"定位中。。。\"\r\n\t\t\talert(msg)\r\n\t\t},\r\n\t\tpunch() {\r\n\t\t\tlet msg = this.options.isContains ? \"可以打卡\" : \"离打卡范围还有十万八千里\"\r\n\t\t\talert(msg)\r\n\t\t}\r\n\t},\r\n\tcomponents: {\r\n\t\tGeolocationMap\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang='scss'>\r\n.map-wrap {\r\n\theight: 63.14vh;\r\n}\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/views/map/gelocationMap.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"map-wrap\"},[_c('geolocation-map',{ref:\"map\",attrs:{\"options\":_vm.options}})],1),_vm._v(\" \"),_c('button',{staticClass:\"mui-btn mui-btn-block mui-block-primary\",on:{\"tap\":_vm.location}},[_vm._v(\"重新定位\")]),_vm._v(\" \"),_c('button',{staticClass:\"mui-btn mui-btn-block mui-block-primary\",on:{\"tap\":_vm.getLocat}},[_vm._v(\"获取位置信息\")]),_vm._v(\" \"),_c('div',[_vm._v(_vm._s(_vm.loc))]),_vm._v(\" \"),_c('button',{staticClass:\"mui-btn mui-btn-block mui-block-primary\",on:{\"tap\":_vm.success}},[_vm._v(\"定位完成了没\")]),_vm._v(\" \"),_c('button',{staticClass:\"mui-btn mui-btn-block mui-block-primary\",on:{\"tap\":_vm.punch}},[_vm._v(\"是否在打卡范围\")])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-09a50836\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/map/gelocationMap.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-09a50836\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./gelocationMap.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./gelocationMap.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./gelocationMap.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-09a50836\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./gelocationMap.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/map/gelocationMap.vue\n// module id = null\n// module chunks = ","// 获取网络状态\r\nexport const getNetWorkInfo = () => {\r\n\tvar types = {}\r\n\tlet network = { no: 1, name: \"无网络\" }\r\n\ttypes[plus.networkinfo.CONNECTION_UNKNOW] = \"Unknown connection\"\r\n\ttypes[plus.networkinfo.CONNECTION_NONE] = \"None connection\"\r\n\ttypes[plus.networkinfo.CONNECTION_ETHERNET] = \"Ethernet connection\"\r\n\ttypes[plus.networkinfo.CONNECTION_WIFI] = \"WiFi connection\"\r\n\ttypes[plus.networkinfo.CONNECTION_CELL2G] = \"Cellular 2G connection\"\r\n\ttypes[plus.networkinfo.CONNECTION_CELL3G] = \"Cellular 3G connection\"\r\n\ttypes[plus.networkinfo.CONNECTION_CELL4G] = \"Cellular 4G connection\"\r\n\tlet status = plus.networkinfo.getCurrentType()\r\n\tif(status === 3) { network = { no: 3, name: \"WIFI网络\" } }\r\n\tif(status > 3) { network = { no: 2, name: \"移动流量\" } }\r\n\tif(status === 1) { network = { no: 1, name: \"无网络\" } }\r\n\treturn network\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/common/js/native.js"],"sourceRoot":""}